import{_ as h,r as n,p as x,g as k,s as A,v as E,c as u,o as m,a as o,b as L,w as S,T,x as V,y as c,z as g,A as I,B as f,d as M,j as N,t as q,q as b}from"./CKiwDKMb.js";import C from"/logo.png";import{u as R}from"./C4nQMaHf.js";const U={class:"login-container"},B={class:"login-card"},D={key:0,class:"message message-error"},j={class:"input-group"},z=["disabled"],F={class:"input-group"},G=["disabled"],H={class:"form-options"},J={class:"checkbox-label"},K=["disabled"],O={key:0},P={key:1,class:"loading"},Q={__name:"login",setup(W){const w=A(),{login:_,isLoading:p}=R(),t=n(!1),l=n(""),r=n(!1),s=n({email:"",password:""}),d=x().public.firstAdminEmail||"",v=n("/user-dashboard");k(()=>{const a=w.query.redirect;a&&(v.value=decodeURIComponent(a));const e=localStorage.getItem("rememberedEmail");e&&(s.value.email=e,r.value=!0)});const y=async()=>{t.value=!0,l.value="";try{r.value?localStorage.setItem("rememberedEmail",s.value.email):localStorage.removeItem("rememberedEmail"),console.log("🔐 Attempting login with:",s.value.email),console.log("🔑 Admin email from config:",d),console.log("📧 Email comparison:"),console.log("  - User email:",s.value.email),console.log("  - Admin email:",d),console.log("  - Are equal?:",s.value.email===d);const a=await _(s.value.email,s.value.password);if(console.log("📊 Login result:",a),a.success){console.log("✅ Login successful");const e=s.value.email===d;console.log("👤 Is admin?",e),e?(console.log("🔐 Redirecting to admin dashboard"),await b("/admin/admin-index")):(console.log("📍 Redirecting to user dashboard"),await b(v.value||"/user-dashboard"))}else console.error("❌ Login failed:",a.error),l.value=a.error||"خطا در ورود به سیستم"}catch(a){console.error("❌ Login error:",a),l.value="خطا در ورود به سیستم"}finally{t.value=!1}};return E([()=>s.value.email,()=>s.value.password],()=>{l.value&&(l.value="")}),(a,e)=>(m(),u("div",U,[o("div",B,[e[7]||(e[7]=o("div",{class:"logo-container"},[o("img",{src:C,alt:"Never Say No",class:"logo-image"})],-1)),e[8]||(e[8]=o("h1",null,"ورود به حساب",-1)),e[9]||(e[9]=o("p",{class:"subtitle"},"خوش آمدید، لطفا وارد شوید",-1)),L(T,{name:"fade"},{default:S(()=>[l.value?(m(),u("div",D,q(l.value),1)):N("",!0)]),_:1}),o("form",{onSubmit:V(y,["prevent"]),class:"form"},[o("div",j,[e[3]||(e[3]=o("label",{for:"email",class:"label"},"ایمیل",-1)),c(o("input",{id:"email","onUpdate:modelValue":e[0]||(e[0]=i=>s.value.email=i),type:"email",placeholder:"example@email.com",class:"input-field",required:"",disabled:t.value,autocomplete:"email"},null,8,z),[[g,s.value.email]])]),o("div",F,[e[4]||(e[4]=o("label",{for:"password",class:"label"},"رمز عبور",-1)),c(o("input",{id:"password","onUpdate:modelValue":e[1]||(e[1]=i=>s.value.password=i),type:"password",placeholder:"••••••••",class:"input-field",required:"",disabled:t.value,autocomplete:"current-password"},null,8,G),[[g,s.value.password]])]),o("div",H,[o("label",J,[c(o("input",{type:"checkbox","onUpdate:modelValue":e[2]||(e[2]=i=>r.value=i),class:"checkbox"},null,512),[[I,r.value]]),e[5]||(e[5]=o("span",null,"مرا به خاطر بسپار",-1))])]),o("button",{type:"submit",disabled:t.value||f(p),class:"btn btn-primary"},[!t.value&&!f(p)?(m(),u("span",O,"ورود")):(m(),u("span",P,e[6]||(e[6]=[o("span",{class:"spinner"},null,-1),M(" در حال ورود... ",-1)])))],8,K)],32),e[10]||(e[10]=o("div",{class:"footer-link"},[o("a",{href:"https://t.me/Torinowholesale_bot?start=w42993986",target:"_blank",rel:"noopener noreferrer",class:"link"}," درخواست ایجاد حساب کاربری ")],-1))])]))}},ee=h(Q,[["__scopeId","data-v-cc78f036"]]);export{ee as default};
